# CLAUDE.md

이 파일은 이 저장소에서 코드 작업을 할 때 Claude Code (claude.ai/code)에게 지침을 제공합니다.

## 언어 지침
모든 대화는 한글로 진행합니다.

## 프로젝트 개요
이것은 "리튼" (Litten)이라고 불리는 크로스 플랫폼 노트 앱으로, 리튼 공간을 중심으로 음성 듣기, 텍스트 쓰기, 이미지 필기 기능을 통합 지원합니다. 

### 핵심 개념
- **리튼 공간**: 디렉토리 개념으로 각 리튼 안에 듣기, 쓰기, 필기 데이터가 통합 관리됨
- **음성-쓰기 동기화**: 듣기 중 텍스트 작성이나 필기/스케치 시 해당 내용이 듣기 어느 위치에 해당하는지 자동 저장 및 재생 가능
- **3단계 구독 모델**: 
  * 무료(Free): 리튼 생성 최대 5개, 각 리튼내에 듣기 파일 최대 2개, 쓰기 텍스트 1개, 필기 1개 제한
  * 스탠다드(Standard): 파일 수 제한 없음, 광고 제거
  * 프리미엄(Premium): 로그인 및 파일 서버 보관, 웹에서 편집 가능
- **30개 언어 지원**: 글로벌 사용자를 위한 다국어 인터페이스
- **시스템 언어 자동 감지**: 앱 설치 시 시스템 언어를 자동으로 감지하여 30개 지원 언어 중 해당 언어로 자동 설정
- **언어별 테마 자동 선택**: 감지된 언어/국가에 따라 해당 지역이 선호하는 5가지 테마(Classic Blue, Dark Mode, Nature Green, Sunset Orange, Monochrome Grey) 중 자동으로 선택되어 적용
- **크로스 플랫폼**: Android, iOS, Web, Desktop 지원

### 기술 스택
#### Frontend
- **Framework**: Flutter (Dart)
- **상태 관리**: Provider 패턴
- **UI**: Material Design 3
- **플랫폼**: Android, iOS, Web, Linux, macOS, Windows

#### Backend  
- **Framework**: Java Spring Boot
- **데이터베이스**: MariaDB
- **파일 저장소**: AWS S3
- **API**: RESTful API
- **인증**: JWT + 앱 고유 ID

## 개발 단계별 계획

### 1차 개발: 무료 버전 (1-6개월)
- **타겟**: 모바일 앱 (Android/iOS) 핵심 기능 완성
- **핵심 기능**: 
  * 음성 듣기/재생
  * 텍스트 쓰기 (리치 텍스트 에디터)
  * 이미지 필기/주석 (PDF→JPEG 변환 포함)
  * 로컬 저장
  * 30개 언어 + 5가지 테마
  * 광고 표시
- **결과**: 앱스토어 출시

### 2차 개발: 스탠다드 버전 (7-9개월)  
- **타겟**: 광고 제거 + 서버 동기화
- **핵심 기능**:
  * 사용자 로그인 시스템
  * 백엔드 서버 구축
  * 클라우드 동기화
  * 광고 제거
  * 구독 결제 시스템 (스탠다드 플랜)
- **결과**: 스탠다드 서비스 런칭

### 3차 개발: 프리미엄 버전 (10-12개월)
- **타겟**: 웹에서 동일한 기능 사용 + 고급 기능
- **핵심 기능**:
  * Flutter Web 앱 개발
  * 모바일과 동일한 모든 기능
  * 크로스 플랫폼 동기화 (모바일 ↔ 웹)
  * PWA 지원
  * 고급 기능: 대용량 파일 지원, 팀 협업, API 접근
  * 구독 결제 시스템 (프리미엄 플랜)
- **결과**: 프리미엄 서비스 런칭

## 핵심 개발 원칙
- 완전한 기능 단위로 작업: 작은 조각이 아닌 완전한 기능 단위로 개발합니다.
- 단순함 우선: 모든 변경은 최소한의 코드에 영향을 주도록 합니다.
- 품질 우선: 기능, 코드 품질, 성능, 보안을 동시에 고려합니다.
- 작업내용 업데이트: 진행 완료 후 md 파일을 업데이트하고 작업 내역을 기술합니다.
- **계획 모드**: md 파일만 작성하고 실제 코드 작성을 진행하지 않습니다.
- **자동 승인 모드**: `auto-accept edits on` 모드에서는 bash 명령이 사용자 확인 없이 바로 실행됩니다.

## 작업 프로세스

### 1. 사전 개발 요구사항
현재 기획 단계에서는:
- 기획 문서들을 검토하고 이해합니다.
- 구체적인 개발 TODO 체크리스트를 작성합니다.
- 생성할 파일과 디렉토리 구조를 정의합니다.
- 기존 프로젝트가 있다면 코드베이스를 읽고 이해합니다.

### 2. 기획 단계
- [ ] 명확한 기능 정의
- [ ] 단계별 TODO 리스트  
- [ ] 예상 파일 변경 범위
- [ ] 잠재적 위험 요소
- [ ] 성공 기준 정의

코딩 전 반드시 사람의 승인을 기다립니다.

### 3. 구현 단계
각 TODO에 대해 다음을 수행합니다:
- 완전한 기능 단위로 메소드를 구현합니다.
- 파일 변경은 최소화합니다.
- 즉시 동작 가능한 코드를 작성합니다.
- 상세 로그를 적극적으로 작성합니다:
  * 함수 진입/종료 지점
  * 주요 변수 값 변경
  * API 요청/응답
  * 잠재적 오류 지점
  * 조건 분기 결과
- 상위 수준에서 변경 요약을 제공합니다.
- 해당 TODO 항목에 완료 표시를 합니다.

### 4. 품질 확인
항상 다음을 확인합니다:
- 코드 품질 개선 기회
- 성능 최적화 가능성  
- 보안 취약점 존재 여부
- 테스트 필요 여부

### 5. 문제 해결
오류 발생 시:
- 우선 기존 로그 출력을 확인하고 분석합니다.
- 필요 시 로그를 보강합니다:
  * 문제의 5가지 근본 원인 분석
  * 각 원인별 식별 로그 생성
  * 더 세분화된 디버깅 포인트 추가
- 로그 결과로 정확한 위치를 파악합니다.
- 원인 제거 방식을 단계적으로 적용합니다.

### 6. 완료 단계
완료되면:
- 모든 변경된 코드를 리뷰합니다.
- 원래 계획과 비교합니다.
- `projectplan.md`에 리뷰 섹션을 추가합니다:
  * 구현된 변경사항 요약
  * 발견된 문제 및 해결 방법
  * 향후 개선 방향
  * 관련 파일 태그

## 금지사항

### 절대 하지 말아야 할 것
절대 하지 마세요:
- 대규모/복잡한 변경
- 의도하지 않은 결과를 그대로 둠
- 문맥 과부하 발생
- 나쁜 코드 확산
- 계획 없이 즉흥적 코딩

### 즉시 중단해야 할 상황
다음이 감지되면 즉시 중단하세요:
- 계획과 다른 방향으로 진행 중
- 코드가 복잡해짐
- 오류 원인을 이해하지 못함
- 변경 범위가 예상보다 큼

## 개발 명령어 (예정)

현재는 기획 단계이므로 아래 명령어들은 Flutter 프로젝트 생성 후 사용할 예정입니다.

```bash
# Flutter 프로젝트 생성 (최초 1회)
flutter create liten_app

# Flutter 앱 디렉토리로 이동
cd liten_app

# 의존성 설치
flutter pub get

# 기본 개발 명령어
flutter run                    # 디버그 모드 실행
flutter test                   # 테스트 실행
flutter analyze               # 코드 분석
flutter gen-l10n              # 지역화 파일 생성

# 빌드 명령어 (추후)
flutter build apk --release   # Android 릴리즈
flutter build web             # Web 빌드
```

## 프로젝트 구조

현재 프로젝트는 기획 단계입니다. Flutter 앱은 `liten_app/` 디렉토리에 구성될 예정이며, 6개 플랫폼(Android, iOS, Web, Linux, macOS, Windows)을 지원할 계획입니다.

### 예상 디렉토리 구조
```
liten_ex2/
├── liten_app/          # Flutter 앱 메인 디렉토리 (예정)
│   ├── lib/
│   │   ├── main.dart
│   │   ├── config/     # 앱 설정
│   │   ├── services/   # 비즈니스 로직 서비스
│   │   ├── providers/  # 상태 관리 (Provider 패턴)
│   │   ├── screens/    # UI 화면들
│   │   ├── widgets/    # 재사용 컴포넌트
│   │   └── l10n/       # 다국어 지원 파일
│   ├── pubspec.yaml    # Flutter 의존성 관리
│   └── test/           # 테스트 파일들
├── docs/               # 프로젝트 문서 (현재 위치)
└── CLAUDE.md           # Claude 개발 지침
```


## 아키텍처

### 계획된 핵심 구조
- **Provider 패턴**: 상태 관리를 위한 `provider` 패키지 사용 예정
- **서비스 레이어**: 각 기능별 서비스 분리 (오디오, 텍스트, 필기, 설정 등)
- **다국어 지원**: 30개 언어를 위한 Flutter 국제화 적용 완료
- **중앙화된 설정**: `lib/config/` 에서 앱 전체 설정 관리
- **기본 언어**: 영어 (en)

### 계획된 주요 구성 요소

#### 1단계: 기본 앱 구조 (MVP)
- `AppConfig`: 앱 전체 설정 관리
- `LocaleProvider`: 다국어 지원 상태 관리
- `NavigationService`: 화면 전환 관리
- `PreferencesService`: 사용자 설정 저장/불러오기

#### 2단계: 핵심 기능
- `NoteService`: 리튼 공간 생성/관리
- `AudioService`: 음성 녹음/재생
- `TextService`: 텍스트 작성/편집
- `DrawingService`: 필기/스케치
- `StorageService`: 로컬 파일 관리

#### 3단계: 고급 기능 (추후)
- `ExportService`: 파일 내보내기
- `SearchService`: 내용 검색
- `BackupService`: 로컬 백업
- `SyncService`: 클라우드 동기화 (장기 계획)

## 다국어 지원 계획

### 지원 언어 (30개) - 1단계에서 모두 지원 (사용자 제공 순서)
1. 영어 (en) - English (기본값)
2. 중국어 (zh) - Chinese
3. 힌디어 (hi) - हिन्दी
4. 스페인어 (es) - Español
5. 프랑스어 (fr) - Français
6. 아랍어 (ar) - العربية
7. 벵골어 (bn) - বাংলা
8. 러시아어 (ru) - Русский
9. 포르투갈어 (pt) - Português
10. 우르두어 (ur) - اردو
11. 인도네시아어 (id) - Bahasa Indonesia
12. 독일어 (de) - Deutsch
13. 일본어 (ja) - 日本語
14. 스와힐리어 (sw) - Kiswahili
15. 마라티어 (mr) - मराठी
16. 텔루구어 (te) - తెలుగు
17. 터키어 (tr) - Türkçe
18. 타밀어 (ta) - தமிழ்
19. 페르시아어 (fa) - فارسی
20. 한국어 (ko) - 한국어
21. 우크라이나어 (uk) - Українська
22. 이탈리아어 (it) - Italiano
23. 타갈로그어 (tl) - Filipino
24. 폴란드어 (pl) - Polski
25. 파슈토어 (ps) - پښتو
26. 말레이어 (ms) - Bahasa Melayu
27. 로마니아어 (ro) - Română
28. 네덜란드어 (nl) - Nederlands
29. 하우사어 (ha) - Hausa
30. 태국어 (th) - ไทย

### 구현 계획
- ARB 파일을 `lib/l10n/` 에 배치 예정
- Flutter 기본 국제화 시스템 사용
- 첫 실행 시 기본 언어 선택 화면 제공
- 기본 언어: 영어 (en)
- SharedPreferences로 언어 설정 저장

### 개발 우선순위
**1단계에서 30개 언어 모두 지원 **

구현 순서 (위의 지원 언어 목록 순서대로):
1. 영어 (en) - English (기본값)
2. 중국어 (zh) - Chinese
3. 힌디어 (hi) - हिन्दी
4. 스페인어 (es) - Español
5. 프랑스어 (fr) - Français
6. 아랍어 (ar) - العربية
7. 벵골어 (bn) - বাংলা
8. 러시아어 (ru) - Русский
9. 포르투갈어 (pt) - Português
10. 우르두어 (ur) - اردو
11. 인도네시아어 (id) - Bahasa Indonesia
12. 독일어 (de) - Deutsch
13. 일본어 (ja) - 日本語
14. 스와힐리어 (sw) - Kiswahili
15. 마라티어 (mr) - मराठी
16. 텔루구어 (te) - తెలుగు
17. 터키어 (tr) - Türkçe
18. 타밀어 (ta) - தமிழ்
19. 페르시아어 (fa) - فارسی
20. 한국어 (ko) - 한국어
21. 우크라이나어 (uk) - Українська
22. 이탈리아어 (it) - Italiano
23. 타갈로그어 (tl) - Filipino
24. 폴란드어 (pl) - Polski
25. 파슈토어 (ps) - پښتو
26. 말레이어 (ms) - Bahasa Melayu
27. 로마니아어 (ro) - Română
28. 네덜란드어 (nl) - Nederlands
29. 하우사어 (ha) - Hausa
30. 태국어 (th) - ไทย

**구현 현황**: 30/30 언어
